import{r as l,j as e}from"./ui-C_rQOgPK.js";import{u as w,P as k}from"./Home-D9vmEk3y.js";import{C as u,e as x,B as v}from"./index-DwWsHBqf.js";import{u as N}from"./Header-DwhnZD7I.js";import{I as f,G as _,H as I,w as S,J as E,K as y}from"./utils-D89tvFug.js";import"./usePullToRefresh-BlXlUhj0.js";import"./router-DqSa9lVt.js";class T{accessToken;baseUrl="https://graph.instagram.com";constructor(s){this.accessToken=s}async getUserMedia(s=12,o){try{const n=new URLSearchParams({access_token:this.accessToken,fields:"id,media_type,media_url,permalink,caption,timestamp,like_count,comments_count",limit:s.toString()});o&&n.append("after",o);const i=await fetch(`${this.baseUrl}/me/media?${n}`);if(!i.ok)throw new Error(`Instagram API error: ${i.status} ${i.statusText}`);return(await i.json()).data.map(this.transformInstagramMedia)}catch(n){throw console.error("Error fetching Instagram media:",n),n}}async refreshAccessToken(){try{const s=await fetch(`${this.baseUrl}/refresh_access_token`,{method:"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify({grant_type:"ig_refresh_token",access_token:this.accessToken})});if(!s.ok)throw new Error("Failed to refresh access token");const o=await s.json();return this.accessToken=o.access_token,this.accessToken}catch(s){throw console.error("Error refreshing access token:",s),s}}transformInstagramMedia(s){return{id:parseInt(s.id),image:s.media_url,caption:s.caption||"",link:s.permalink,likes:s.like_count||0,comments:s.comments_count||0,timestamp:s.timestamp,type:this.mapMediaType(s.media_type)}}mapMediaType(s){switch(s){case"IMAGE":return"image";case"VIDEO":return"video";case"CAROUSEL_ALBUM":return"carousel";default:return"image"}}}const D=new T(""),V=()=>{const{ref:d,isVisible:s}=w(.2),[o,n]=l.useState([]),[i,c]=l.useState(!0),[m,h]=l.useState(null),[$,b]=l.useState(null),{t:r}=N(),p=l.useCallback(async()=>{try{c(!0),h(null);const a=await fetch("/instagram-posts.json");if(!a.ok)throw new Error(r("instagram.error.loadFailed","Failed to load Instagram posts"));const t=await a.json();n(t),b(new Date)}catch(a){console.error("Error loading Instagram posts:",a),h(r("instagram.error.feedFailed","Failed to load Instagram feed. Please try again later."))}finally{c(!1)}},[r]);l.useEffect(()=>{p()},[p]);const j=async a=>{if(navigator.share)try{await navigator.share({title:r("instagram.share.title","Check out this photo"),text:a.caption,url:a.link})}catch{console.log("Share cancelled or not supported")}else navigator.clipboard.writeText(a.link)};return e.jsx("section",{id:"instagram",ref:d,className:"py-6 md:py-16 md:px-6","aria-labelledby":"instagram-heading",role:"region",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:`text-center mb-12 transition-all duration-700 ${s?"animate-fade-in-up":"opacity-0 translate-y-8"}`,children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[e.jsx(f,{className:"w-6 h-6","aria-hidden":"true"}),e.jsx("h2",{id:"instagram-heading",className:"text-2xl font-light",children:r("instagram.title","Instagram Feed")})]}),e.jsx("p",{className:"text-muted-foreground mb-4",children:r("instagram.description","Latest moments from my photography journey")})]}),m&&e.jsx(u,{className:"mb-8 border-red-200",children:e.jsxs(x,{className:"flex items-center justify-center py-8",children:[e.jsx(_,{className:"w-5 h-5 text-red-500 mr-2"}),e.jsx("span",{className:"text-red-600",children:m})]})}),i&&e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-4 mb-8",children:Array.from({length:15}).map((a,t)=>e.jsx("div",{className:"aspect-square bg-gray-200 animate-pulse rounded-lg",style:{animationDelay:`${t*50}ms`}},t))}),!i&&!m&&e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-4",role:"list","aria-label":r("instagram.ariaLabel","Instagram posts grid"),children:o.map((a,t)=>e.jsx("div",{style:{animationDelay:`${t*100}ms`},role:"listitem",className:`group cursor-pointer transition-all duration-700 ${s?"animate-scale-in":"opacity-0 scale-95"}`,children:e.jsx(u,{className:"overflow-hidden border-0 shadow-none",children:e.jsx(x,{className:"p-0",children:e.jsxs("a",{href:a.link,target:"_blank",rel:"noopener noreferrer",className:"block aspect-square overflow-hidden rounded-lg relative","aria-label":a.caption?`View Instagram post: ${a.caption}`:`View Instagram post ${t+1}`,children:[e.jsx(k,{loading:"lazy",src:a.image,applyAspectRatioBox:!0,alt:a.caption||`Instagram post ${t+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),e.jsxs("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors duration-300",children:[e.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1",children:[a.likes!==void 0&&e.jsxs("div",{className:"flex items-center space-x-1 bg-black/50 text-white px-2 py-1 rounded text-xs",children:[e.jsx(I,{className:"w-3 h-3"}),e.jsx("span",{children:a.likes})]}),a.comments!==void 0&&e.jsxs("div",{className:"flex items-center space-x-1 bg-black/50 text-white px-2 py-1 rounded text-xs",children:[e.jsx(S,{className:"w-3 h-3"}),e.jsx("span",{children:a.comments})]})]}),e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsx("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),j(a)},className:"bg-black/50 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300 hover:bg-black/70","aria-label":r("instagram.share.ariaLabel","Share this post"),children:e.jsx(E,{className:"w-4 h-4"})})}),a.type&&e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx(v,{variant:"secondary",className:"text-xs bg-black/50 text-white border-0",children:a.type==="video"?"ðŸŽ¥":a.type==="carousel"?"ðŸ“·":"ðŸ“¸"})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx(y,{className:"w-6 h-6 text-white drop-shadow-lg"})})]})]})})})},a.id))}),e.jsx("div",{className:"text-center mt-8",children:e.jsxs("a",{href:"https://www.instagram.com/_ab__photography_01__/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-2 text-primary hover:text-primary/80 transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded-sm px-4 py-2 border border-primary/20 hover:border-primary/40 rounded-lg","aria-label":r("instagram.follow.ariaLabel","View the full Instagram profile (opens in new tab)"),children:[e.jsx(f,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{children:r("instagram.follow","Follow on Instagram")}),e.jsx(y,{className:"w-3 h-3"})]})})]})})};export{V as default};
